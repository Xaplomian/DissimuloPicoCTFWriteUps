# Client-side-again
Can you break into this super secure portal? 
https://2019shell1.picoctf.com/problem/12278/ ([link](https://2019shell1.picoctf.com/problem/12278/)) or http://2019shell1.picoctf.com:12278

## Hint
What is obfuscation?

## Solution
Like the previous client side challenge, you are prompted to inspect the portal's internal code.  
In the javascript code, you can find this
```javascript
var _0x5a46=['0a0d8}','_again_4','this','Password\x20Verified','Incorrect\x20password','getElementById','value','substring','picoCTF{','not_this'];(function(_0x4bd822,_0x2bd6f7){var _0xb4bdb3=function(_0x1d68f6){while(--_0x1d68f6){_0x4bd822['push'](_0x4bd822['shift']());}};_0xb4bdb3(++_0x2bd6f7);}(_0x5a46,0x1b3));var _0x4b5b=function(_0x2d8f05,_0x4b81bb){_0x2d8f05=_0x2d8f05-0x0;var _0x4d74cb=_0x5a46[_0x2d8f05];return _0x4d74cb;};function verify(){checkpass=document[_0x4b5b('0x0')]('pass')[_0x4b5b('0x1')];split=0x4;if(checkpass[_0x4b5b('0x2')](0x0,split*0x2)==_0x4b5b('0x3')){if(checkpass[_0x4b5b('0x2')](0x7,0x9)=='{n'){if(checkpass[_0x4b5b('0x2')](split*0x2,split*0x2*0x2)==_0x4b5b('0x4')){if(checkpass[_0x4b5b('0x2')](0x3,0x6)=='oCT'){if(checkpass[_0x4b5b('0x2')](split*0x3*0x2,split*0x4*0x2)==_0x4b5b('0x5')){if(checkpass['substring'](0x6,0xb)=='F{not'){if(checkpass[_0x4b5b('0x2')](split*0x2*0x2,split*0x3*0x2)==_0x4b5b('0x6')){if(checkpass[_0x4b5b('0x2')](0xc,0x10)==_0x4b5b('0x7')){alert(_0x4b5b('0x8'));}}}}}}}}else{alert(_0x4b5b('0x9'));}}
```
 
 which is obfuscated (as implied in the hint)  
 when pretty printed, it becomes:  
 ```javascript
 (function(_0x4bd822, _0x2bd6f7) {
    var _0xb4bdb3 = function(_0x1d68f6) {
        while (--_0x1d68f6) {
            _0x4bd822['push'](_0x4bd822['shift']());
        }
    };
    _0xb4bdb3(++_0x2bd6f7);
}(_0x5a46, 0x1b3));
var _0x4b5b = function(_0x2d8f05, _0x4b81bb) {
    _0x2d8f05 = _0x2d8f05 - 0x0;
    var _0x4d74cb = _0x5a46[_0x2d8f05];
    return _0x4d74cb;
};

function verify() {
    checkpass = document[_0x4b5b('0')]('pass')[_0x4b5b('1')];
    split = 4;
    if (checkpass[_0x4b5b('2')](0x0, split * 0x2) == _0x4b5b('3')) {
        if (checkpass[_0x4b5b('2')](7, 9) == '{n') {
            if (checkpass[_0x4b5b('0x2')](split * 2, split * 2 * 2) == _0x4b5b('4')) {
                if (checkpass[_0x4b5b('2')](3, 6) == 'oCT') {
                    if (checkpass[_0x4b5b('2')](split * 3 * 2, split * 4 * 2) == _0x4b5b('5')) {
                        if (checkpass['substring'](6, 11) == 'F{not') {
                            if (checkpass[_0x4b5b('0x2')](split * 2 * 2, split * 3 * 2) == _0x4b5b('6')) {
                                if (checkpass[_0x4b5b('2')](12, 16) == _0x4b5b('7')) {
                                    alert(_0x4b5b('0x8'));
                                }
                            }
                        }
                    }
                }
            }
        }
    } else {
        alert(_0x4b5b('9'));
    }
}
```

when simplified it becomes:  
```javascript
 (function(_0x4bd822, _0x2bd6f7) {
    var _0xb4bdb3 = function(_0x1d68f6) {
        while (--_0x1d68f6) {
            _0x4bd822['push'](_0x4bd822['shift']());
        }
    };
    _0xb4bdb3(++_0x2bd6f7);
}(_0x5a46, 0x1b3));
var _0x4b5b = function(_0x2d8f05, _0x4b81bb) {
    _0x2d8f05 = _0x2d8f05 - 0x0;
    var _0x4d74cb = _0x5a46[_0x2d8f05];
    return _0x4d74cb;
};

function verify() {
    checkpass = document[_0x4b5b('0')]('pass')[_0x4b5b('1')];
    split = 4;
    if (checkpass[_0x4b5b('2')](0, split * 2) == _0x4b5b('3')) {
        if (checkpass[_0x4b5b('2')](7, 9) == '{n') {
            if (checkpass[_0x4b5b('2')](split * 2, split * 2 * 2) == _0x4b5b('0x4')) {
                if (checkpass[_0x4b5b('2')](3, 6) == 'oCT') {
                    if (checkpass[_0x4b5b('2')](split * 3 * 2, split * 4 * 2) == _0x4b5b('5')) {
                        if (checkpass['substring'](6, 11) == 'F{not') {
                            if (checkpass[_0x4b5b('2')](split * 2 * 2, split * 3 * 2) == _0x4b5b('6')) {
                                if (checkpass[_0x4b5b('2')](12, 16) == _0x4b5b('7')) {
                                    alert(_0x4b5b('8'));
                                }
                            }
                        }
                    }
                }
            }
        }
    } else {
        alert(_0x4b5b('0x9'));
    }
}
```

when replaced hex stuff with proper stuff, it becomes:
```
function verify() {
    checkpass = document['getElementById']('pass')['value'];
    split = 4;
    if (checkpass['substring'](0, split * 2) == 'picoCTF{') {
        if (checkpass['substring'](7, 9) == '{n') {
            if (checkpass['substring'](split * 2, split * 2 * 2) == 'not_this') {
                if (checkpass['substring'](3, 6) == 'oCT') {
                    if (checkpass['substring'](split * 3 * 2, split * 4 * 2) == '0a0d8}) {
                        if (checkpass['substring'](6, 11) == 'F{not') {
                            if (checkpass['substring'](split * 2 * 2, split * 3 * 2) == '_again_4') {
                                if (checkpass['substring'](12, 16) == 'this') {
                                    alert('Password Verified');
                                }
                            }
                        }
                    }
                }
            }
        }
    } else {
        alert('Incorrect Password');
    }
}
```

 

## Details
Done by: `Ryan`  
Completed: *During challenge*  
Flag: `flag`  
